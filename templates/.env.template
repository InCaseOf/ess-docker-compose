# Matrix Server Environment Configuration
# Copy this file to .env and fill in all values
# DO NOT commit .env to version control!

# ============================================
# Domain Configuration
# ============================================

# Your Matrix server domain (e.g., matrix.example.com)
MATRIX_DOMAIN=matrix.example.com

# Your Element web client domain (e.g., element.example.com)
ELEMENT_DOMAIN=element.example.com

# Your Element Call domain (e.g., call.example.com)
ELEMENT_CALL_DOMAIN=call.example.com

# Your LiveKit domain (e.g., livekit.example.com)
LIVEKIT_DOMAIN=livekit.example.com

# ============================================
# Database Configuration
# ============================================

# PostgreSQL database password
# Generate with: openssl rand -base64 24 | tr -d "=+/" | cut -c1-32
# IMPORTANT: Must be alphanumeric only (no special characters)
# CRITICAL: If you change this, you MUST also update:
#   - synapse/config/homeserver.yaml (database.args.password)
#   - mas/config/config.yaml (database.uri)
POSTGRES_PASSWORD=CHANGE_ME_32_CHARS_ALPHANUMERIC

# ============================================
# Synapse Configuration
# ============================================

# Registration shared secret (for creating admin users)
# Generate with: openssl rand -base64 32 | tr -d "=+/"
SYNAPSE_REGISTRATION_SHARED_SECRET=CHANGE_ME_LONG_RANDOM_STRING

# ============================================
# MAS (Matrix Authentication Service) Configuration
# ============================================

# MAS encryption secret (MUST be exactly 64 hex characters)
# Generate with: openssl rand -hex 32
MAS_SECRETS_ENCRYPTION=CHANGE_ME_64_HEX_CHARACTERS

# MAS signing key (MAS v1.8.0+)
# NOTE: No longer stored as env var - generate EC key and paste directly into mas/config/config.yaml
# Generate with: openssl ecparam -name prime256v1 -genkey
# See templates/mas-config.yaml for proper format

# ============================================
# OIDC / Upstream Provider Configuration (Optional)
# ============================================
# Only required if using upstream OIDC provider like Authelia or Authentik

# Upstream OIDC server URL (e.g., https://auth.example.com)
OIDC_ISSUER_URL=https://auth.example.com

# OIDC Client ID for MAS
OIDC_CLIENT_ID=matrix_mas

# OIDC Client Secret
# Generate with: openssl rand -base64 32 | tr -d "=+/"
OIDC_CLIENT_SECRET=CHANGE_ME_LONG_RANDOM_STRING

# ============================================
# Authentik Specific Configuration
# ============================================
# If using Authentik, ensure you have created an OAuth2/OpenID Provider

# Authentik URL (same as OIDC_ISSUER_URL usually)
# AUTHENTIK_URL=https://authentik.example.com

# ============================================
# LiveKit Configuration (for Element Call)
# ============================================

# LiveKit API Key
# Generate with: openssl rand -hex 16
LIVEKIT_API_KEY=CHANGE_ME_32_HEX_CHARACTERS

# LiveKit API Secret
# Generate with: openssl rand -base64 32 | tr -d "=+/"
LIVEKIT_API_SECRET=CHANGE_ME_LONG_RANDOM_STRING

# ============================================
# Secret Generation Quick Reference
# ============================================
#
# Database Password (32 chars, alphanumeric only):
#   openssl rand -base64 24 | tr -d "=+/" | cut -c1-32
#
# Synapse Registration Secret:
#   openssl rand -base64 32 | tr -d "=+/"
#
# MAS Encryption Secret (64 hex chars):
#   openssl rand -hex 32
#
# MAS Signing Key (MAS v1.8.0+, paste directly in config file):
#   openssl ecparam -name prime256v1 -genkey
#
# OIDC Client Secret:
#   openssl rand -base64 32 | tr -d "=+/"
#
# LiveKit Secrets:
#   openssl rand -hex 16
#   openssl rand -base64 32 | tr -d "=+/"
#
# Hash OIDC Secret for Authelia (run on Authelia server):
#   authelia crypto hash generate pbkdf2 --password 'YOUR_CLIENT_SECRET'
#
# ============================================
